/*
	ëœë¤ ë¬¸ìì—´ ë§Œë“œëŠ” í•¨ìˆ˜ int ê°’ìœ¼ë¡œ ìë¦¬ìˆ˜ ì„¤ì •ê°€ëŠ¥

**/

private static final String CHAR_SET = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

	public static String generateRandomString(int length) {
		StringBuilder randomString = new StringBuilder(length);
		SecureRandom secureRandom = new SecureRandom();

		for (int i = 0; i < length; i++) {
			int randomIndex = secureRandom.nextInt(CHAR_SET.length());
			char randomChar = CHAR_SET.charAt(randomIndex);
			randomString.append(randomChar);
		}

		return randomString.toString();
	}

/**
	ë©”ì¼ ë³´ë‚´ëŠ” í•¨ìˆ˜

*/
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.MailSender;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.stereotype.Service;

@Service("mailService")
public class MailService {

	@Autowired
	private MailSender mailSender;
	
	public void sendEmail(String toAddress, String fromAddress,
					String subject, String msgBody) {
		SimpleMailMessage smm = new SimpleMailMessage();
		smm.setFrom(fromAddress);
		smm.setTo(toAddress);
		smm.setSubject(subject);
		smm.setText(msgBody);
		
		mailSender.send(smm);
	}
}


/**
		ë©”ì¼ í•¨ìˆ˜ ì˜ˆì œ
*/


@RequestMapping("mail.do")
	public ModelAndView sendEmail(String id, String email) throws Exception {
		ModelAndView mv = new ModelAndView();
		
		String addr = "ë³´ë‚´ëŠ” ì‚¬ëŒ ë©”ì¼";
		
		String subject = "[ğŸ˜€ğŸ˜€] ì•Œë¦¼ë©”ì¼ ì…ë‹ˆë‹¤.";
		
		String body = "ì•ˆë…•í•˜ì„¸ìš”?\r\nì†Œí†µí•´ìš”~\r\n SMTPë©”ì¼ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.";
		
		mailService.sendEmail(email, addr, subject, body);
		
		mv.setViewName("main");
		return mv;
	}


/**
 servlet-context.xml ì— ì¶”ê°€í•˜ëŠ” í´ë˜ìŠ¤

*/

<beans:bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
		<beans:property name="host" value="smtp.gmail.com"/>
		<beans:property name="port" value="587"/>
		<beans:property name="defaultEncoding" value="utf-8"/>
		<beans:property name="username" value="ë³¸ì¸ êµ¬ê¸€ ë©”ì¼"/>
		<beans:property name="password" value="ì•± ë¹„ë°€ë²ˆí˜¸ ë§Œë“œëŠ”ë°©ë²• ì •ì„ ì´ ë¶€ë¥´ìƒ˜"/>
		<beans:property name="javaMailProperties">
			<beans:props>
				<beans:prop key="mail.transport.protocol">smtp</beans:prop>
				<beans:prop key="mail.smtp.auth">true</beans:prop> <!-- 2ë‹¨ê³„ë³¸ì¸ì¸ì¦ì„ í–ˆìœ¼ë‹ˆ ë³´ì•ˆì ìœ¼ë¡œ trueë¼ê³  ì¤€ë‹¤ -->
				<beans:prop key="mail.smtp.starttls.enable">true</beans:prop>
				<beans:prop key="mail.debug">true</beans:prop>
			</beans:props>
		</beans:property>
	</beans:bean>
	
	<context:component-scan base-package="spring.service" />



/**

pom.xml ì— ì¶”ê°€í•˜ëŠ” jar íŒŒì¼ 

*/


<!-- ë©”ì¼ ì´ìš©-->
		<dependency>
			<groupId>javax.mail</groupId>
			<artifactId>mail</artifactId>
			<version>1.4.7</version>
		</dependency>

		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context-support</artifactId>
			<version>${org.springframework-version}</version>
		</dependency>
